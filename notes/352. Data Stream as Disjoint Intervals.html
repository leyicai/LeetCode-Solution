<html>
<head>
  <title>352. Data Stream as Disjoint Intervals</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <meta name="content-class" content="maxiang"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="787"/>
<h1>352. Data Stream as Disjoint Intervals</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>Tags:</b></td><td><i>Array, Hard</i></td></tr>
</table>
</div>
<br/>

<div><span lang="v2" style="color: #2c3f51; font-family: Candara, Microsoft Yahei, 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, Song, sans-serif; font-size: 15px; line-height: 1.6; background: none;"><del style="position:relative;display:block;z-index:10;"><a href="http://maxiang.io/#/?provider=evernote&amp;guid=80eacc37-5887-4517-b553-4ebeff934fae&amp;notebook=LeetCode" style="position: absolute;color: #FFF;text-decoration: none;font-size: 12px;height: 25px;border-radius: 0;margin-top: -20px;right: 15px;background: rgba(0, 0, 0, 0);border-left: 10px solid #BB3A34;border-right: 10px solid #BB3A34;border-bottom: 5px solid rgba(0, 0, 0, 0);width: 0;text-indent:-100000px;">Edit</a></del><div style="color: #3e3e3e; font-family: Candara, Microsoft Yahei, 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, Song, sans-serif; font-size: 15px; line-height: 1.6;">
                        
                    



<h1 style="margin-top: 21px; font-family: inherit; margin-bottom: 10.5px; color: #3e3e3e; font-weight: bold; line-height: 1.2; margin: 20px 0; text-align: left; padding-left: 15px; word-break: break-all; font-size: 32px; border-left: 8px solid #71BA51;">352. Data Stream as Disjoint Intervals</h1>

<p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;"> <br style="color: #3e3e3e;"/>
Given a data stream input of non-negative integers a1, a2, …, an, …, summarize the numbers seen so far as a list of disjoint intervals. <br style="color: #3e3e3e;"/>
For example, suppose the integers from the data stream are 1, 3, 7, 2, 6, …, then the summary will be:</p>

<blockquote style="border-left-width: 10px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; color: #3e3e3e; margin: 0px; border-left: 10px solid rgba(128,128,128,0.075); background-color: rgba(128,128,128,0.05); padding: 13px 15px;">
  <p style="font-size: 1em; font-weight: 300; margin-bottom: 0; text-align: justify; color: #898989; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">[1, 1] <br style="color: #3e3e3e;"/>
  [1, 1], [3, 3] <br style="color: #3e3e3e;"/>
  [1, 1], [3, 3], [7, 7] <br style="color: #3e3e3e;"/>
  [1, 3], [7, 7] <br style="color: #3e3e3e;"/>
  [1, 3], [6, 7]</p>
</blockquote>



<h4 style="margin-bottom: 10.5px; font-family: inherit; margin-top: 10.5px; color: #3e3e3e; line-height: 1.2; font-weight: bold; margin: 20px 0; text-align: left; padding-left: 15px; font-size: 20px; word-break: break-all;">1. Insert Interval(57)</h4>

<p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">addNum:</p>

<ol style="margin-top: 0; margin-bottom: 1.1em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;"><li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Initiate a new interval [val, val]</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Loop through current intervals</p>

<ol style="margin-top: 0; margin-bottom: .55em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;">
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">if new interval ends before current interval start || new interval starts after current interval ends: add into res</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">else if new interval starts before interval ends: overlapped. Use <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">overlap</code> to record the number of intervals that are overlapped, then update res</p></li></ol></li>
</ol>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; word-wrap: break-word; padding: 12px 13px; margin: 0 0 1.1em; line-height: 1.6; word-break: break-all; font-size: 13px; color: #898989; background-color: #f8f8f8; border: 0; border-radius: 3px; text-align: start; position: relative; background: #f2f2f2;"><code style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; border-radius: 0; font-size: inherit; background-color: transparent; color: #333; display: block; overflow-x: auto; background: #f8f8f8; padding: 1.3em 2em; padding-left: 3.3em;"><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">1.</span><span style="color: #3e3e3e; display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">public</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">void</span> <span style="display: inline; line-height: 1.6; color: #900; font-weight: bold; background-color: transparent;">addNum</span><span style="color: #3e3e3e; display: inline; line-height: 1.6; background-color: transparent;">(<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> val)</span> </span>{
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">2.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[] newInterval = <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">new</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[] { val, val };
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">3.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> i = <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>, overlap = <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">4.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">while</span> (i &lt; intervals.size() &amp;&amp; intervals.get(i)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>] &lt; val - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>) {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">5.</span>        i++;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">6.</span>    }
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">7.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">while</span> (i &lt; intervals.size() &amp;&amp; intervals.get(i)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>] &lt;= newInterval[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>] + <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>) {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">8.</span>        newInterval[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>] = Math.min(newInterval[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>], intervals.get(i)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>]);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">9.</span>        newInterval[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>] = Math.max(newInterval[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>], intervals.get(i)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>]);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">10.</span>        overlap++;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">11.</span>        i++;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">12.</span>    }
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">13.</span>    <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// for(int[] inter : intervals){</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">14.</span>    <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// System.out.println(Arrays.toString(inter));</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">15.</span>    <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// }</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">16.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (overlap &gt; <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>) {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">17.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> j = <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">18.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">while</span> (j &lt; overlap) {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">19.</span>            intervals.remove(i - overlap);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">20.</span>            j++;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">21.</span>        }
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">22.</span>    }
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">23.</span>    <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// for(int[] inter : intervals){</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">24.</span>    <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// System.out.println(Arrays.toString(inter));</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">25.</span>    <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// }</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">26.</span>    intervals.add(i - overlap, newInterval);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">27.</span>}
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">28.</span><div style="color: #3e3e3e; line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">29.</span><span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">public</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[][] getIntervals() {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">30.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> intervals.toArray(<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">new</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[intervals.size()][]);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">31.</span>}
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">32.</span><div style="color: #3e3e3e; line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">33.</span><span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">private</span> List&lt;<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[]&gt; intervals;
</div></code></pre>



<h4 style="margin-bottom: 10.5px; font-family: inherit; margin-top: 10.5px; color: #3e3e3e; line-height: 1.2; font-weight: bold; margin: 20px 0; text-align: left; padding-left: 15px; font-size: 20px; word-break: break-all;">TreeMap</h4>

<blockquote style="border-left-width: 10px; border-top-right-radius: 5px; border-bottom-right-radius: 5px; color: #3e3e3e; margin: 0px; border-left: 10px solid rgba(128,128,128,0.075); background-color: rgba(128,128,128,0.05); padding: 13px 15px;">
  <p style="font-size: 1em; font-weight: 300; margin-bottom: 0; text-align: justify; color: #898989; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">TreeMap: <br style="color: #3e3e3e;"/>
  tree.lowerkey(val): return the max key &lt; val <br style="color: #3e3e3e;"/>
  tree.higherkey(val): return the min key &gt; val <br style="color: #3e3e3e;"/>
  tree.floorKey(val): return the max key &lt;= val <br style="color: #3e3e3e;"/>
  O(logn)</p>
</blockquote>

<p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">key is the start of the interval <br style="color: #3e3e3e;"/>
Merge with both  the lower and higher intervals when <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">lowerkey</code>”s end +1 = val &amp;&amp; <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">higherkey</code>’s start == val +1. <br style="color: #3e3e3e;"/>
Or merge it with lower/higher intervals. <br style="color: #3e3e3e;"/>
Or non-overlapping, just add it into the tree. <br style="color: #3e3e3e;"/>
<strong style="font-weight: bold; line-height: 1.6; color: #FD5B03;">Use floorKey instead of lowerKey</strong></p>



<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; word-wrap: break-word; padding: 12px 13px; margin: 0 0 1.1em; line-height: 1.6; word-break: break-all; font-size: 13px; color: #898989; background-color: #f8f8f8; border: 0; border-radius: 3px; text-align: start; position: relative; background: #f2f2f2;"><code style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; border-radius: 0; font-size: inherit; background-color: transparent; color: #333; display: block; overflow-x: auto; background: #f8f8f8; padding: 1.3em 2em; padding-left: 3.3em;"><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">1.</span><span style="color: #3e3e3e; display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">public</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">void</span> <span style="display: inline; line-height: 1.6; color: #900; font-weight: bold; background-color: transparent;">addNum</span><span style="color: #3e3e3e; display: inline; line-height: 1.6; background-color: transparent;">(<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> val)</span> </span>{
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">2.</span>    Integer lowKey = tree.floorKey(val), highKey = tree.higherKey(val);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">3.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (lowKey != <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">null</span> &amp;&amp; highKey != <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">null</span> &amp;&amp; tree.get(lowKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>] == val - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span> &amp;&amp; tree.get(highKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>] == val + <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>) {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">4.</span>        <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// merge with both low and high</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">5.</span>        tree.get(lowKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>] = tree.get(highKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>];
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">6.</span>        tree.remove(highKey);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">7.</span>    } <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">else</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (lowKey != <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">null</span> &amp;&amp; tree.get(lowKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>] &gt;= val - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>) {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">8.</span>        <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// merge with lower one</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">9.</span>        tree.get(lowKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>] = Math.max(tree.get(lowKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>], val);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">10.</span>    } <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">else</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (highKey != <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">null</span> &amp;&amp; tree.get(highKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>] == val + <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>) {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">11.</span>        <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// merge with higher one</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">12.</span>        tree.put(val, <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">new</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[] { val, tree.get(highKey)[<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>] });
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">13.</span>        tree.remove(highKey);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">14.</span>    } <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">else</span> {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">15.</span>        <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// add new interval</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">16.</span>        tree.put(val, <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">new</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[] { val, val });
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">17.</span>    }
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">18.</span>}
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">19.</span><div style="color: #3e3e3e; line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">20.</span><span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">public</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[][] getIntervals() {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">21.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> tree.values().toArray(<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">new</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[tree.size()][]);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">22.</span>}
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">23.</span><div style="color: #3e3e3e; line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">24.</span><span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">private</span> TreeMap&lt;Integer, <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>[]&gt; tree;
</div></code></pre></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%20352.%20Data%20Stream%20as%20Disjoint%20Intervals%0A@%28LeetCode%29%5BArray%2C%20Hard%5D%0AGiven%20a%20data%20stream%20input%20of%20non-negative%20integers%20a1%2C%20a2%2C%20...%2C%20an%2C%20...%2C%20summarize%20the%20numbers%20seen%20so%20far%20as%20a%20list%20of%20disjoint%20intervals.%0AFor%20example%2C%20suppose%20the%20integers%20from%20the%20data%20stream%20are%201%2C%203%2C%207%2C%202%2C%206%2C%20...%2C%20then%20the%20summary%20will%20be%3A%0A%3E%5B1%2C%201%5D%0A%5B1%2C%201%5D%2C%20%5B3%2C%203%5D%0A%5B1%2C%201%5D%2C%20%5B3%2C%203%5D%2C%20%5B7%2C%207%5D%0A%5B1%2C%203%5D%2C%20%5B7%2C%207%5D%0A%5B1%2C%203%5D%2C%20%5B6%2C%207%5D%0A%0A%23%23%23%23%201.%20Insert%20Interval%2857%29%0AaddNum%3A%0A1.%20Initiate%20a%20new%20interval%20%5Bval%2C%20val%5D%0A2.%20Loop%20through%20current%20intervals%0A%093.%20if%20new%20interval%20ends%20before%20current%20interval%20start%20%7C%7C%20new%20interval%20starts%20after%20current%20interval%20ends%3A%20add%20into%20res%0A%094.%20else%20if%20new%20interval%20starts%20before%20interval%20ends%3A%20overlapped.%20Use%20%60overlap%60%20to%20record%20the%20number%20of%20intervals%20that%20are%20overlapped%2C%20then%20update%20res%0A%0A%60%60%60java%0Apublic%20void%20addNum%28int%20val%29%20%7B%0A%20%20%20%20int%5B%5D%20newInterval%20%3D%20new%20int%5B%5D%20%7B%20val%2C%20val%20%7D%3B%0A%20%20%20%20int%20i%20%3D%200%2C%20overlap%20%3D%200%3B%0A%20%20%20%20while%20%28i%20%3C%20intervals.size%28%29%20%26%26%20intervals.get%28i%29%5B1%5D%20%3C%20val%20-%201%29%20%7B%0A%20%20%20%20%20%20%20%20i++%3B%0A%20%20%20%20%7D%0A%20%20%20%20while%20%28i%20%3C%20intervals.size%28%29%20%26%26%20intervals.get%28i%29%5B0%5D%20%3C%3D%20newInterval%5B1%5D%20+%201%29%20%7B%0A%20%20%20%20%20%20%20%20newInterval%5B0%5D%20%3D%20Math.min%28newInterval%5B0%5D%2C%20intervals.get%28i%29%5B0%5D%29%3B%0A%20%20%20%20%20%20%20%20newInterval%5B1%5D%20%3D%20Math.max%28newInterval%5B1%5D%2C%20intervals.get%28i%29%5B1%5D%29%3B%0A%20%20%20%20%20%20%20%20overlap++%3B%0A%20%20%20%20%20%20%20%20i++%3B%0A%20%20%20%20%7D%0A%20%20%20%20//%20for%28int%5B%5D%20inter%20%3A%20intervals%29%7B%0A%20%20%20%20//%20System.out.println%28Arrays.toString%28inter%29%29%3B%0A%20%20%20%20//%20%7D%0A%20%20%20%20if%20%28overlap%20%3E%200%29%20%7B%0A%20%20%20%20%20%20%20%20int%20j%20%3D%200%3B%0A%20%20%20%20%20%20%20%20while%20%28j%20%3C%20overlap%29%20%7B%0A%20%20%20%20%20%20%20%20%20%20%20%20intervals.remove%28i%20-%20overlap%29%3B%0A%20%20%20%20%20%20%20%20%20%20%20%20j++%3B%0A%20%20%20%20%20%20%20%20%7D%0A%20%20%20%20%7D%0A%20%20%20%20//%20for%28int%5B%5D%20inter%20%3A%20intervals%29%7B%0A%20%20%20%20//%20System.out.println%28Arrays.toString%28inter%29%29%3B%0A%20%20%20%20//%20%7D%0A%20%20%20%20intervals.add%28i%20-%20overlap%2C%20newInterval%29%3B%0A%7D%0A%0Apublic%20int%5B%5D%5B%5D%20getIntervals%28%29%20%7B%0A%20%20%20%20return%20intervals.toArray%28new%20int%5Bintervals.size%28%29%5D%5B%5D%29%3B%0A%7D%0A%0Aprivate%20List%3Cint%5B%5D%3E%20intervals%3B%0A%60%60%60%0A%0A%23%23%23%23%20TreeMap%0A%3E%20TreeMap%3A%0A%3E%20tree.lowerkey%28val%29%3A%20return%20the%20max%20key%20%3C%20val%0A%3E%20tree.higherkey%28val%29%3A%20return%20the%20min%20key%20%3E%20val%0A%3E%20tree.floorKey%28val%29%3A%20return%20the%20max%20key%20%3C%3D%20val%0A%3E%20O%28logn%29%0A%0Akey%20is%20the%20start%20of%20the%20interval%0AMerge%20with%20both%20%20the%20lower%20and%20higher%20intervals%20when%20%60lowerkey%60%27%27s%20end%20+1%20%3D%20val%20%26%26%20%60higherkey%60%27s%20start%20%3D%3D%20val%20+1.%0AOr%20merge%20it%20with%20lower/higher%20intervals.%0AOr%20non-overlapping%2C%20just%20add%20it%20into%20the%20tree.%0A**Use%20floorKey%20instead%20of%20lowerKey**%0A%0A%60%60%60java%0Apublic%20void%20addNum%28int%20val%29%20%7B%0A%20%20%20%20Integer%20lowKey%20%3D%20tree.floorKey%28val%29%2C%20highKey%20%3D%20tree.higherKey%28val%29%3B%0A%20%20%20%20if%20%28lowKey%20%21%3D%20null%20%26%26%20highKey%20%21%3D%20null%20%26%26%20tree.get%28lowKey%29%5B1%5D%20%3D%3D%20val%20-%201%20%26%26%20tree.get%28highKey%29%5B0%5D%20%3D%3D%20val%20+%201%29%20%7B%0A%20%20%20%20%20%20%20%20//%20merge%20with%20both%20low%20and%20high%0A%20%20%20%20%20%20%20%20tree.get%28lowKey%29%5B1%5D%20%3D%20tree.get%28highKey%29%5B1%5D%3B%0A%20%20%20%20%20%20%20%20tree.remove%28highKey%29%3B%0A%20%20%20%20%7D%20else%20if%20%28lowKey%20%21%3D%20null%20%26%26%20tree.get%28lowKey%29%5B1%5D%20%3E%3D%20val%20-%201%29%20%7B%0A%20%20%20%20%20%20%20%20//%20merge%20with%20lower%20one%0A%20%20%20%20%20%20%20%20tree.get%28lowKey%29%5B1%5D%20%3D%20Math.max%28tree.get%28lowKey%29%5B1%5D%2C%20val%29%3B%0A%20%20%20%20%7D%20else%20if%20%28highKey%20%21%3D%20null%20%26%26%20tree.get%28highKey%29%5B0%5D%20%3D%3D%20val%20+%201%29%20%7B%0A%20%20%20%20%20%20%20%20//%20merge%20with%20higher%20one%0A%20%20%20%20%20%20%20%20tree.put%28val%2C%20new%20int%5B%5D%20%7B%20val%2C%20tree.get%28highKey%29%5B1%5D%20%7D%29%3B%0A%20%20%20%20%20%20%20%20tree.remove%28highKey%29%3B%0A%20%20%20%20%7D%20else%20%7B%0A%20%20%20%20%20%20%20%20//%20add%20new%20interval%0A%20%20%20%20%20%20%20%20tree.put%28val%2C%20new%20int%5B%5D%20%7B%20val%2C%20val%20%7D%29%3B%0A%20%20%20%20%7D%0A%7D%0A%0Apublic%20int%5B%5D%5B%5D%20getIntervals%28%29%20%7B%0A%20%20%20%20return%20tree.values%28%29.toArray%28new%20int%5Btree.size%28%29%5D%5B%5D%29%3B%0A%7D%0A%0Aprivate%20TreeMap%3CInteger%2C%20int%5B%5D%3E%20tree%3B%0A%60%60%60</center><br/></span>
</div></body></html> 