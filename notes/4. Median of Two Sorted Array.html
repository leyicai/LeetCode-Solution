<html>
<head>
  <title>4. Median of Two Sorted Array</title>
  <basefont face="Segoe UI" size="2" />
  <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
  <meta name="exporter-version" content="YXBJ Windows/600753 (en-US, DDL); Windows/10.0.0 (Win64);"/>
  <meta name="content-class" content="maxiang"/>
  <style>
    body, td {
      font-family: Segoe UI;
      font-size: 10pt;
    }
  </style>
</head>
<body>
<a name="716"/>
<h1>4. Median of Two Sorted Array</h1>
<div>
<table bgcolor="#D4DDE5" border="0">
<tr><td><b>Tags:</b></td><td><i>Array, Binary Search, Hard</i></td></tr>
</table>
</div>
<br/>

<div><span lang="v2" style="color: #2c3f51; font-family: Candara, Microsoft Yahei, 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, Song, sans-serif; font-size: 15px; line-height: 1.6; background: none;"><del style="position:relative;display:block;z-index:10;"><a href="http://maxiang.io/#/?provider=evernote&amp;guid=11529470-b4de-4e32-bfa5-b89375c14bcd&amp;notebook=LeetCode" style="position: absolute;color: #FFF;text-decoration: none;font-size: 12px;height: 25px;border-radius: 0;margin-top: -20px;right: 15px;background: rgba(0, 0, 0, 0);border-left: 10px solid #BB3A34;border-right: 10px solid #BB3A34;border-bottom: 5px solid rgba(0, 0, 0, 0);width: 0;text-indent:-100000px;">Edit</a></del><div style="color: #3e3e3e; font-family: Candara, Microsoft Yahei, 'Helvetica Neue', Arial, 'Hiragino Sans GB', STHeiti, 'Microsoft YaHei', 'WenQuanYi Micro Hei', SimSun, Song, sans-serif; font-size: 15px; line-height: 1.6;">
                        
                    



<h1 style="margin-top: 21px; font-family: inherit; margin-bottom: 10.5px; color: #3e3e3e; font-weight: bold; line-height: 1.2; margin: 20px 0; text-align: left; padding-left: 15px; word-break: break-all; font-size: 32px; border-left: 8px solid #71BA51;">4. Median of Two Sorted Array</h1>

<p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;"></p>



<h4 style="margin-bottom: 10.5px; font-family: inherit; margin-top: 10.5px; color: #3e3e3e; line-height: 1.2; font-weight: bold; margin: 20px 0; text-align: left; padding-left: 15px; font-size: 20px; word-break: break-all;">1</h4>

<ol style="margin-top: 0; margin-bottom: 1.1em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;"><li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;"><code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">n</code> is the length of two array. The median must be the average of <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">(n+1)/2</code>th and <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">(n+2)/2</code>th elements.</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Recursively find the kth smallest elements from array <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">a[i:]</code> and <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">b[j:]</code></p>

<ul style="margin-top: 0; margin-bottom: .55em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;">
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Pre-check: </p>

<ul style="margin-top: 0; margin-bottom: .55em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;">
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">if one of the array is exausted, the kth one must be in the other one</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">if k==1: compare the first element of two arrays</p></li></ul></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Binary Search: find <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">k/2</code>th element in <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">a</code> and <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">b</code> separately</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Compare the median(<code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">k/2</code>) of  remaining <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">a</code> and <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">b</code> and choose.</p>

<ul style="margin-top: 0; margin-bottom: .55em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;">
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">if aMid &lt; bMid: the kth must not in <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">a[i: i+k/2</code>]. We move the start point of <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">a</code> by k/2.</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">else: We move the start point of <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">b</code> by k/2</p></li></ul></li></ul></li>
</ol>

<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; word-wrap: break-word; padding: 12px 13px; margin: 0 0 1.1em; line-height: 1.6; word-break: break-all; font-size: 13px; color: #898989; background-color: #f8f8f8; border: 0; border-radius: 3px; text-align: start; position: relative; background: #f2f2f2;"><code style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; border-radius: 0; font-size: inherit; background-color: transparent; color: #333; display: block; overflow-x: auto; background: #f8f8f8; padding: 1.3em 2em; padding-left: 3.3em;"><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">1.</span> <span style="color: #3e3e3e; display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">double</span> <span style="display: inline; line-height: 1.6; color: #900; font-weight: bold; background-color: transparent;">kth</span><span style="color: #3e3e3e; display: inline; line-height: 1.6; background-color: transparent;">(<span style="display: inline; line-height: 1.6; color: #0086b3; background-color: transparent;">vector</span>&lt;<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>&gt;&amp; a, <span style="display: inline; line-height: 1.6; color: #0086b3; background-color: transparent;">vector</span>&lt;<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>&gt;&amp; b, <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> i, <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> j, <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> k)</span> </span>{
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">2.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (i &gt;= a.size())
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">3.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> b[j + k - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>];
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">4.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (j &gt;= b.size())
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">5.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> a[i + k - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>];
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">6.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (k == <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>)
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">7.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> min(a[i], b[j]);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">8.</span><div style="color: #3e3e3e; line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">9.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> aMid = INT_MAX, bMid = INT_MAX;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">10.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (i + k / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span> - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span> &lt; a.size())
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">11.</span>        aMid = a[i + k / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span> - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>];
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">12.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (j + k / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span> - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span> &lt; b.size())
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">13.</span>        bMid = b[j + k / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span> - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>];
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">14.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (aMid &lt; bMid)
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">15.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> kth(a, b, i + k / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>, j, k - k / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">16.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">else</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">17.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> kth(a, b, i, j + k / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>, k - k / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>);
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">18.</span>}
</div></code></pre>



<h4 style="margin-bottom: 10.5px; font-family: inherit; margin-top: 10.5px; color: #3e3e3e; line-height: 1.2; font-weight: bold; margin: 20px 0; text-align: left; padding-left: 15px; font-size: 20px; word-break: break-all;">2</h4>

<ol style="margin-top: 0; margin-bottom: 1.1em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;"><li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Add a few imaginary ‘positions’ (represented as #’s) in between numbers, and treat numbers as ‘positions’ as well. <br style="color: #3e3e3e;"/>
<img src="4. Median of Two Sorted Array_files/.1564567884207.png" type="image/png" data-filename=".1564567884207.png" alt="Alt text" longdesc="./1564567884207.png" style="border: 0; vertical-align: middle; max-width: 100%; color: #3e3e3e;" title=""/> <br style="color: #3e3e3e;"/>
 index(L) = (CutPosition-1)/2, index(R) = (CutPosition)/2.</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">For two array:</p>

<ol style="margin-top: 0; margin-bottom: .55em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;">
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">there are 2N1 + 2N2 + 2 position altogether. Therefore, there must be exactly N1 + N2 positions on each side of the cut, and 2 positions directly on the cut.</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Therefore, when we cut at position C2 = K in A2, then the cut position in A1 must be C1 = N1 + N2 - k.</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;"><strong style="font-weight: bold; line-height: 1.6; color: #FD5B03;">L1 = A1[(C1-1)/2]; R1 = A1[C1/2];  L2 = A2[(C2-1)/2]; R2 = A2[C2/2];</strong></p></li></ol></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">To decide the cut position, we need to ensure <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">L1 &lt;= R1 &amp;&amp; L1 &lt;= R2 &amp;&amp; L2 &lt;= R1 &amp;&amp; L2 &lt;= R2</code>, which can be simplified to <code style="font-family: 'Source Code Pro',Consolas,monospace; font-size: .9em; padding: 2px 4px; background-color: #f9f2f4; white-space: normal; border-radius: 4px; color: #a71d5d;">L1 &lt;= R2 and L2 &lt;= R1.</code> <strong style="font-weight: bold; line-height: 1.6; color: #FD5B03;">Binary Search</strong> <br style="color: #3e3e3e;"/>
Therefore:</p>

<ul style="margin-top: 0; margin-bottom: .55em; color: #3e3e3e; padding-left: 30px; line-height: 1.6;">
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">If we have L1 &gt; R2, it means there are too many large numbers on the left half of A1, then we must move C1 to the left (i.e. move C2 to the right); </p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">If L2 &gt; R1, then there are too many large numbers on the left half of A2, and we must move C2 to the left.</p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">Otherwise, this cut is the right one. </p></li>
<li style="color: #3e3e3e; line-height: 24px;"><p style="color: #3e3e3e; text-align: justify; margin: 6px 0; line-height: 1.2; min-height: 1em; box-sizing: border-box; word-wrap: break-word;">After we find the cut, the medium can be computed as (max(L1, L2) + min(R1, R2)) / 2;</p></li></ul></li>
</ol>

<pre style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; display: block; word-wrap: break-word; padding: 12px 13px; margin: 0 0 1.1em; line-height: 1.6; word-break: break-all; font-size: 13px; color: #898989; background-color: #f8f8f8; border: 0; border-radius: 3px; text-align: start; position: relative; background: #f2f2f2;"><code style="font-family: 'Source Code Pro',Consolas,monospace; white-space: pre-wrap; border-radius: 0; font-size: inherit; background-color: transparent; color: #333; display: block; overflow-x: auto; background: #f8f8f8; padding: 1.3em 2em; padding-left: 3.3em;"><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">1.</span> <span style="color: #3e3e3e; display: inline; line-height: 1.6; background-color: transparent;"><span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">double</span> <span style="display: inline; line-height: 1.6; color: #900; font-weight: bold; background-color: transparent;">findMedianSortedArrays</span><span style="color: #3e3e3e; display: inline; line-height: 1.6; background-color: transparent;">(<span style="display: inline; line-height: 1.6; color: #0086b3; background-color: transparent;">vector</span>&lt;<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>&gt;&amp; nums1, <span style="display: inline; line-height: 1.6; color: #0086b3; background-color: transparent;">vector</span>&lt;<span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span>&gt;&amp; nums2)</span> </span>{
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">2.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> N1 = nums1.size();
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">3.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> N2 = nums2.size();
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">4.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (N1 &lt; N2) <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> findMedianSortedArrays(nums2, nums1);   <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// Make sure A2 is the shorter one.</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">5.</span><div style="color: #3e3e3e; line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">6.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> lo = <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>, hi = N2 * <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">7.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">while</span> (lo &lt;= hi) {
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">8.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> mid2 = (lo + hi) / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>;   <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// Try Cut 2 </span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">9.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">int</span> mid1 = N1 + N2 - mid2;  <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// Calculate Cut 1 accordingly</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">10.</span><div style="color: #3e3e3e; line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">11.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">double</span> L1 = (mid1 == <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>) ? INT_MIN : nums1[(mid1<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">-1</span>)/<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>];  <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// Get L1, R1, L2, R2 respectively</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">12.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">double</span> L2 = (mid2 == <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">0</span>) ? INT_MIN : nums2[(mid2<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">-1</span>)/<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>];
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">13.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">double</span> R1 = (mid1 == N1 * <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>) ? INT_MAX : nums1[(mid1)/<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>];
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">14.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">double</span> R2 = (mid2 == N2 * <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>) ? INT_MAX : nums2[(mid2)/<span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>];
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">15.</span><div style="color: #3e3e3e; line-height: 1.6;"></div>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">16.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (L1 &gt; R2) lo = mid2 + <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>;     <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// A1's lower half is too big; need to move C1 left (C2 right)</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">17.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">else</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">if</span> (L2 &gt; R1) hi = mid2 - <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">1</span>;    <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// A2's lower half too big; need to move C2 left.</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">18.</span>        <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">else</span> <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> (max(L1,L2) + min(R1, R2)) / <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">2</span>; <span style="display: inline; line-height: 1.6; color: #998; font-style: italic; background-color: transparent;">// Otherwise, that's the right cut.</span>
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">19.</span>    }
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">20.</span>    <span style="display: inline; line-height: 1.6; color: #333; font-weight: bold; background-color: transparent;">return</span> <span style="display: inline; line-height: 1.6; color: #008080; background-color: transparent;">-1</span>;
</div><div style="min-height: 1.5em; color: #3e3e3e; line-height: 1.6; background-color: transparent;"><span style="line-height: 1.6; color: #998; font-style: italic; min-width: 2.2em; display: inline-block; text-align: right; opacity: .8; position: absolute; left: .3em; background-color: transparent;">21.</span>} 
</div></code></pre></div><center style="display:none !important;visibility:collapse !important;height:0 !important;white-space:nowrap;width:100%;overflow:hidden">%23%204.%20Median%20of%20Two%20Sorted%20Array%0A@%28LeetCode%29%5BHard%2C%20Array%2C%20Binary%20Search%5D%0A%23%23%23%23%201%0A1.%20%60n%60%20is%20the%20length%20of%20two%20array.%20The%20median%20must%20be%20the%20average%20of%20%60%28n+1%29/2%60th%20and%20%60%28n+2%29/2%60th%20elements.%0A2.%20Recursively%20find%20the%20kth%20smallest%20elements%20from%20array%20%60a%5Bi%3A%5D%60%20and%20%60b%5Bj%3A%5D%60%0A%09-%20Pre-check%3A%20%0A%09%09-%20if%20one%20of%20the%20array%20is%20exausted%2C%20the%20kth%20one%20must%20be%20in%20the%20other%20one%0A%09%09-%20if%20k%3D%3D1%3A%20compare%20the%20first%20element%20of%20two%20arrays%0A%09-%20Binary%20Search%3A%20find%20%60k/2%60th%20element%20in%20%60a%60%20and%20%60b%60%20separately%0A%09-%20Compare%20the%20median%28%60k/2%60%29%20of%20%20remaining%20%60a%60%20and%20%60b%60%20and%20choose.%0A%09%09-%20if%20aMid%20%3C%20bMid%3A%20the%20kth%20must%20not%20in%20%60a%5Bi%3A%20i+k/2%60%5D.%20We%20move%20the%20start%20point%20of%20%60a%60%20by%20k/2.%0A%09%09-%20%20else%3A%20We%20move%20the%20start%20point%20of%20%60b%60%20by%20k/2%0A%60%60%60cpp%0A%20double%20kth%28vector%3Cint%3E%26%20a%2C%20vector%3Cint%3E%26%20b%2C%20int%20i%2C%20int%20j%2C%20int%20k%29%20%7B%0A%09if%20%28i%20%3E%3D%20a.size%28%29%29%0A%09%09return%20b%5Bj%20+%20k%20-%201%5D%3B%0A%09if%20%28j%20%3E%3D%20b.size%28%29%29%0A%09%09return%20a%5Bi%20+%20k%20-%201%5D%3B%0A%09if%20%28k%20%3D%3D%201%29%0A%09%09return%20min%28a%5Bi%5D%2C%20b%5Bj%5D%29%3B%0A%0A%09int%20aMid%20%3D%20INT_MAX%2C%20bMid%20%3D%20INT_MAX%3B%0A%09if%20%28i%20+%20k%20/%202%20-%201%20%3C%20a.size%28%29%29%0A%09%09aMid%20%3D%20a%5Bi%20+%20k%20/%202%20-%201%5D%3B%0A%09if%20%28j%20+%20k%20/%202%20-%201%20%3C%20b.size%28%29%29%0A%09%09bMid%20%3D%20b%5Bj%20+%20k%20/%202%20-%201%5D%3B%0A%09if%20%28aMid%20%3C%20bMid%29%0A%09%09return%20kth%28a%2C%20b%2C%20i%20+%20k%20/%202%2C%20j%2C%20k%20-%20k%20/%202%29%3B%0A%09else%0A%09%09return%20kth%28a%2C%20b%2C%20i%2C%20j%20+%20k%20/%202%2C%20k%20-%20k%20/%202%29%3B%0A%7D%0A%60%60%60%0A%23%23%23%23%202%0A1.%20Add%20a%20few%20imaginary%20%27positions%27%20%28represented%20as%20%23%27s%29%20in%20between%20numbers%2C%20and%20treat%20numbers%20as%20%27positions%27%20as%20well.%0A%20%21%5BAlt%20text%5D%28./1564567884207.png%29%0A%09%20index%28L%29%20%3D%20%28CutPosition-1%29/2%2C%20index%28R%29%20%3D%20%28CutPosition%29/2.%0A2.%20For%20two%20array%3A%0A%093.%20%20there%20are%202N1%20+%202N2%20+%202%20position%20altogether.%20Therefore%2C%20there%20must%20be%20exactly%20N1%20+%20N2%20positions%20on%20each%20side%20of%20the%20cut%2C%20and%202%20positions%20directly%20on%20the%20cut.%0A%094.%20%20Therefore%2C%20when%20we%20cut%20at%20position%20C2%20%3D%20K%20in%20A2%2C%20then%20the%20cut%20position%20in%20A1%20must%20be%20C1%20%3D%20N1%20+%20N2%20-%20k.%0A%095.%20%20**L1%20%3D%20A1%5B%28C1-1%29/2%5D%3B%20R1%20%3D%20A1%5BC1/2%5D%3B%20%20L2%20%3D%20A2%5B%28C2-1%29/2%5D%3B%20R2%20%3D%20A2%5BC2/2%5D%3B**%0A6.%20%20To%20decide%20the%20cut%20position%2C%20we%20need%20to%20ensure%20%60L1%20%3C%3D%20R1%20%26%26%20L1%20%3C%3D%20R2%20%26%26%20L2%20%3C%3D%20R1%20%26%26%20L2%20%3C%3D%20R2%60%2C%20which%20can%20be%20simplified%20to%20%60L1%20%3C%3D%20R2%20and%20L2%20%3C%3D%20R1.%60%20**Binary%20Search**%0ATherefore%3A%0A%20-%20If%20we%20have%20L1%20%3E%20R2%2C%20it%20means%20there%20are%20too%20many%20large%20numbers%20on%20the%20left%20half%20of%20A1%2C%20then%20we%20must%20move%20C1%20to%20the%20left%20%28i.e.%20move%20C2%20to%20the%20right%29%3B%20%0A%20-%20If%20L2%20%3E%20R1%2C%20then%20there%20are%20too%20many%20large%20numbers%20on%20the%20left%20half%20of%20A2%2C%20and%20we%20must%20move%20C2%20to%20the%20left.%0A%20-%20Otherwise%2C%20this%20cut%20is%20the%20right%20one.%20%0A%20-%20After%20we%20find%20the%20cut%2C%20the%20medium%20can%20be%20computed%20as%20%28max%28L1%2C%20L2%29%20+%20min%28R1%2C%20R2%29%29%20/%202%3B%0A%0A%0A%60%60%60cpp%0A%20double%20findMedianSortedArrays%28vector%3Cint%3E%26%20nums1%2C%20vector%3Cint%3E%26%20nums2%29%20%7B%0A%20%20%20%20int%20N1%20%3D%20nums1.size%28%29%3B%0A%20%20%20%20int%20N2%20%3D%20nums2.size%28%29%3B%0A%20%20%20%20if%20%28N1%20%3C%20N2%29%20return%20findMedianSortedArrays%28nums2%2C%20nums1%29%3B%09//%20Make%20sure%20A2%20is%20the%20shorter%20one.%0A%20%20%20%20%0A%20%20%20%20int%20lo%20%3D%200%2C%20hi%20%3D%20N2%20*%202%3B%0A%20%20%20%20while%20%28lo%20%3C%3D%20hi%29%20%7B%0A%20%20%20%20%20%20%20%20int%20mid2%20%3D%20%28lo%20+%20hi%29%20/%202%3B%20%20%20//%20Try%20Cut%202%20%0A%20%20%20%20%20%20%20%20int%20mid1%20%3D%20N1%20+%20N2%20-%20mid2%3B%20%20//%20Calculate%20Cut%201%20accordingly%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20double%20L1%20%3D%20%28mid1%20%3D%3D%200%29%20%3F%20INT_MIN%20%3A%20nums1%5B%28mid1-1%29/2%5D%3B%09//%20Get%20L1%2C%20R1%2C%20L2%2C%20R2%20respectively%0A%20%20%20%20%20%20%20%20double%20L2%20%3D%20%28mid2%20%3D%3D%200%29%20%3F%20INT_MIN%20%3A%20nums2%5B%28mid2-1%29/2%5D%3B%0A%20%20%20%20%20%20%20%20double%20R1%20%3D%20%28mid1%20%3D%3D%20N1%20*%202%29%20%3F%20INT_MAX%20%3A%20nums1%5B%28mid1%29/2%5D%3B%0A%20%20%20%20%20%20%20%20double%20R2%20%3D%20%28mid2%20%3D%3D%20N2%20*%202%29%20%3F%20INT_MAX%20%3A%20nums2%5B%28mid2%29/2%5D%3B%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20if%20%28L1%20%3E%20R2%29%20lo%20%3D%20mid2%20+%201%3B%09%09//%20A1%27s%20lower%20half%20is%20too%20big%3B%20need%20to%20move%20C1%20left%20%28C2%20right%29%0A%20%20%20%20%20%20%20%20else%20if%20%28L2%20%3E%20R1%29%20hi%20%3D%20mid2%20-%201%3B%09//%20A2%27s%20lower%20half%20too%20big%3B%20need%20to%20move%20C2%20left.%0A%20%20%20%20%20%20%20%20else%20return%20%28max%28L1%2CL2%29%20+%20min%28R1%2C%20R2%29%29%20/%202%3B%09//%20Otherwise%2C%20that%27s%20the%20right%20cut.%0A%20%20%20%20%7D%0A%20%20%20%20return%20-1%3B%0A%7D%20%0A%60%60%60</center><br/></span>
</div></body></html> 